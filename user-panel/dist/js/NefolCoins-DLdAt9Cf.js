import{u as e,g as t,j as a}from"./index-41pQXMpP.js";import{r as s}from"./react-vendor-D-XgqoRR.js";import{W as r,o as l,p as i,T as n,A as c,c as o,q as m}from"./ui-vendor-D0H4cakl.js";import"./socket-vendor-CUkmNz_4.js";function d(){const{user:d}=e(),[x,h]=s.useState(!0),[g,p]=s.useState(null),[u,f]=s.useState(0),[b,y]=s.useState(0),[j,w]=s.useState([]);s.useEffect(()=>{N();const e=()=>{N()};window.addEventListener("coinsUpdated",e);const t=setInterval(()=>{N()},3e4);return()=>{window.removeEventListener("coinsUpdated",e),clearInterval(t)}},[]);const N=async()=>{try{const s=0===j.length;s&&h(!0);const r=localStorage.getItem("token");if(s)try{await fetch(`${t()}/api/cashback/process-retroactive`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}})}catch(e){}const l=await fetch(`${t()}/api/nefol-coins`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(l.ok){const e=await l.json();f(e.nefol_coins||0)}try{const e=await fetch(`${t()}/api/affiliate/dashboard`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(e.ok){const t=await e.json();if(t.total_earnings){const e=Math.floor(10*t.total_earnings);y(e)}}else 404===e.status&&y(0)}catch(a){}const i=await fetch(`${t()}/api/cashback/wallet`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(i.ok){const e=await i.json();p(e)}const n=await fetch(`${t()}/api/coin-transactions`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(n.ok){const e=await n.json(),t=Array.isArray(e)?e:e.data||[];w(t)}}catch(a){}finally{h(!1)}},v=e=>{const t=new Date(e),a=(new Date).getTime()-t.getTime(),s=Math.floor(a/6e4);if(s<1)return"Just now";if(s<60)return`${s} mins ago`;const r=Math.floor(s/60);if(r<24)return`${r} hours ago`;const l=Math.floor(r/24);return l<7?`${l} days ago`:t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},k=e=>{switch(e){case"earned":case"referral_bonus":case"order_bonus":case"cashback":case"withdrawal_completed":return a.jsx(n,{className:"w-5 h-5 text-green-600"});case"redeemed":return a.jsx(i,{className:"w-5 h-5 text-blue-600"});case"purchase_bonus":return a.jsx(l,{className:"w-5 h-5 text-purple-600"});case"withdrawal_pending":case"withdrawal_processing":return a.jsx(o,{className:"w-5 h-5 text-yellow-600"});case"withdrawal_rejected":case"withdrawal_failed":return a.jsx(m,{className:"w-5 h-5 text-red-600"});default:return a.jsx(o,{className:"w-5 h-5 text-gray-600"})}},S=e=>{const t={pending:"bg-yellow-100 text-yellow-800 border-yellow-300",processing:"bg-blue-100 text-blue-800 border-blue-300",completed:"bg-green-100 text-green-800 border-green-300",rejected:"bg-red-100 text-red-800 border-red-300",failed:"bg-red-100 text-red-800 border-red-300",cancelled:"bg-gray-100 text-gray-800 border-gray-300"};return e?a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold border ${t[e]||t.pending}`,children:e.charAt(0).toUpperCase()+e.slice(1)}):null};if(x)return a.jsx("main",{className:"min-h-screen bg-white flex items-center justify-center",style:{fontFamily:"var(--font-body-family, Inter, sans-serif)"},children:a.jsx("div",{className:"text-center",children:a.jsx("p",{className:"text-slate-600",style:{color:"#666"},children:"Loading your coins..."})})});const C=u,F=(null==g?void 0:g.balance)?Math.floor(10*Number(g.balance)):0;return a.jsxs("main",{className:"min-h-screen bg-white overflow-x-hidden py-8 sm:py-12 md:py-16",style:{fontFamily:"var(--font-body-family, Inter, sans-serif)"},children:[a.jsx("style",{children:"\n        :root {\n          --arctic-blue-primary: #7DD3D3;\n          --arctic-blue-primary-hover: #5EC4C4;\n          --arctic-blue-primary-dark: #4A9FAF;\n          --arctic-blue-light: #E0F5F5;\n          --arctic-blue-lighter: #F0F9F9;\n          --arctic-blue-background: #F4F9F9;\n        }\n      "}),a.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"mb-12 sm:mb-16",children:[a.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-light tracking-[0.15em] mb-6",style:{color:"#1a1a1a",fontFamily:'var(--font-heading-family, "Cormorant Garamond", serif)',letterSpacing:"0.15em"},children:"nefol coins"}),a.jsx("p",{className:"text-sm sm:text-base font-light tracking-wide",style:{color:"#666",letterSpacing:"0.05em"},children:"Earn coins with every purchase and enjoy exclusive rewards"})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 p-6 sm:p-8 mb-8 shadow-sm",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("p",{className:"text-sm sm:text-base font-light mb-4 tracking-wide",style:{color:"#666",letterSpacing:"0.05em"},children:"your total balance"}),a.jsxs("div",{className:"mb-6",style:{display:"flex",alignItems:"baseline",justifyContent:"center",gap:"0.5rem"},children:[a.jsx("p",{className:"text-lg sm:text-xl font-bold",style:{color:"rgb(26, 26, 26)",fontVariantNumeric:"tabular-nums",lineHeight:"1"},children:C.toLocaleString()}),a.jsx("span",{className:"text-lg sm:text-xl font-bold",style:{color:"rgb(26, 26, 26)"},children:"coins"})]}),u>=10&&a.jsxs("button",{onClick:()=>window.location.hash="#/user/coin-withdrawal",className:"inline-flex items-center gap-2 px-6 sm:px-8 py-3 text-xs sm:text-sm font-light transition-all duration-300 tracking-[0.15em] uppercase rounded-xl",style:{backgroundColor:"var(--arctic-blue-primary)",color:"#fff",letterSpacing:"0.15em"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--arctic-blue-primary-hover)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="var(--arctic-blue-primary)"},children:[a.jsx(r,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"withdraw coins"]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 sm:gap-8 pt-8 border-t border-slate-100",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-xs sm:text-sm font-light mb-3 tracking-wide",style:{color:"#666",letterSpacing:"0.05em"},children:"loyalty points"}),a.jsx("p",{className:"text-lg sm:text-xl font-bold",style:{color:"#1a1a1a",fontVariantNumeric:"tabular-nums",lineHeight:"1"},children:u.toLocaleString()})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-xs sm:text-sm font-light mb-3 tracking-wide",style:{color:"#666",letterSpacing:"0.05em"},children:"cashback"}),a.jsxs("p",{className:"text-lg sm:text-xl font-bold",style:{color:"#1a1a1a",fontVariantNumeric:"tabular-nums",lineHeight:"1"},children:["₹",(Number(null==g?void 0:g.balance)||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]}),F>0&&a.jsxs("p",{className:"text-xs mt-1 font-light tracking-wide",style:{color:"#999",letterSpacing:"0.02em"},children:["(",F.toLocaleString()," coins)"]})]}),b>0&&a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-xs sm:text-sm font-light mb-3 tracking-wide",style:{color:"#666",letterSpacing:"0.05em"},children:"from referrals"}),a.jsx("p",{className:"text-lg sm:text-xl font-bold mb-1",style:{color:"#1a1a1a",fontVariantNumeric:"tabular-nums",lineHeight:"1"},children:b.toLocaleString()}),a.jsxs("p",{className:"text-lg sm:text-xl font-bold",style:{color:"#1a1a1a",fontVariantNumeric:"tabular-nums",lineHeight:"1"},children:["(₹",(b/10).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}),")"]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 p-6 sm:p-8 shadow-sm",children:[a.jsx("h3",{className:"text-2xl sm:text-3xl font-light mb-6 tracking-[0.15em]",style:{color:"#1a1a1a",fontFamily:'var(--font-heading-family, "Cormorant Garamond", serif)',letterSpacing:"0.15em"},children:"how to earn"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--arctic-blue-light)"},children:a.jsx(l,{className:"w-6 h-6",style:{color:"var(--arctic-blue-primary-dark)"}})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-base sm:text-lg font-light mb-1 tracking-wide",style:{color:"#1a1a1a",letterSpacing:"0.05em"},children:"make a purchase"}),a.jsx("p",{className:"text-sm font-light tracking-wide",style:{color:"#666",letterSpacing:"0.02em"},children:"Earn coins for every purchase you make"})]})]}),a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--arctic-blue-light)"},children:a.jsx(i,{className:"w-6 h-6",style:{color:"var(--arctic-blue-primary-dark)"}})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-base sm:text-lg font-light mb-1 tracking-wide",style:{color:"#1a1a1a",letterSpacing:"0.05em"},children:"refer friends"}),a.jsx("p",{className:"text-sm font-light tracking-wide",style:{color:"#666",letterSpacing:"0.02em"},children:"Earn coins from affiliate referrals (1 rupee earned = 10 coins)"}),b>0&&a.jsxs("p",{className:"text-xs mt-2 font-light tracking-wide",style:{color:"var(--arctic-blue-primary-dark)",letterSpacing:"0.02em"},children:[b.toLocaleString()," coins earned"]})]})]}),a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--arctic-blue-light)"},children:a.jsx(n,{className:"w-6 h-6",style:{color:"var(--arctic-blue-primary-dark)"}})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-base sm:text-lg font-light mb-1 tracking-wide",style:{color:"#1a1a1a",letterSpacing:"0.05em"},children:"loyalty rewards"}),a.jsx("p",{className:"text-sm font-light tracking-wide",style:{color:"#666",letterSpacing:"0.02em"},children:"Earn 5% cashback on all orders"})]})]})]})]}),g&&g.totalSpent>0&&a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 p-6 sm:p-8 shadow-sm",children:[a.jsx("h3",{className:"text-2xl sm:text-3xl font-light mb-6 tracking-[0.15em]",style:{color:"#1a1a1a",fontFamily:'var(--font-heading-family, "Cormorant Garamond", serif)',letterSpacing:"0.15em"},children:"your statistics"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"pb-6 border-b border-slate-100",children:[a.jsx("p",{className:"text-xs sm:text-sm font-light mb-2 tracking-wide",style:{color:"#666",letterSpacing:"0.05em"},children:"total spent"}),a.jsxs("p",{className:"text-2xl sm:text-3xl font-light",style:{color:"#1a1a1a",fontFamily:'var(--font-heading-family, "Cormorant Garamond", serif)',fontVariantNumeric:"tabular-nums",lineHeight:"1",letterSpacing:"0.05em"},children:["₹",g.totalSpent.toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm font-light mb-2 tracking-wide",style:{color:"#666",letterSpacing:"0.05em"},children:"cashback earned"}),a.jsxs("p",{className:"text-2xl sm:text-3xl font-light",style:{color:"#1a1a1a",fontFamily:'var(--font-heading-family, "Cormorant Garamond", serif)',fontVariantNumeric:"tabular-nums",lineHeight:"1",letterSpacing:"0.05em"},children:["₹",(Number(g.balance)||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 p-6 sm:p-8 shadow-sm",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-2xl sm:text-3xl font-light tracking-[0.15em]",style:{color:"#1a1a1a",fontFamily:'var(--font-heading-family, "Cormorant Garamond", serif)',letterSpacing:"0.15em"},children:"recent transactions"}),j.length>0&&a.jsxs("a",{href:"#/user/coin-withdrawal",className:"flex items-center gap-1 text-sm font-light tracking-wide transition-opacity hover:opacity-70",style:{color:"#666",letterSpacing:"0.05em"},children:["view all",a.jsx(c,{className:"w-4 h-4"})]})]}),j.length>0?a.jsx("div",{className:"space-y-4",children:j.slice(0,10).map(e=>{const t=e.type.includes("withdrawal");return a.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 pb-4 last:border-b-0 last:pb-0 hover:opacity-70 transition-opacity",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[k(e.type),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm sm:text-base font-light mb-1 tracking-wide",style:{color:"#1a1a1a",letterSpacing:"0.02em"},children:e.description}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{className:"text-xs font-light tracking-wide",style:{color:"#999",letterSpacing:"0.02em"},children:v(e.created_at)}),S(e.status)]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-base sm:text-lg font-light tracking-wide "+(t?"text-red-600":"text-green-600"),style:{fontVariantNumeric:"tabular-nums",lineHeight:"1",letterSpacing:"0.05em"},children:[t?"-":"+",e.amount.toLocaleString()]}),a.jsx("p",{className:"text-xs font-light tracking-wide mt-1",style:{color:"#999",letterSpacing:"0.02em"},children:"coins"})]})]},e.id)})}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(o,{className:"w-12 h-12 mx-auto mb-4",style:{color:"#999"}}),a.jsx("p",{className:"text-sm font-light tracking-wide mb-6",style:{color:"#666",letterSpacing:"0.02em"},children:"No transactions yet. Start shopping to earn coins!"}),a.jsxs("a",{href:"#/user/shop",className:"inline-flex items-center gap-2 px-6 py-3 text-xs font-light transition-all duration-300 tracking-[0.15em] uppercase rounded-xl",style:{backgroundColor:"var(--arctic-blue-primary)",color:"#fff",letterSpacing:"0.15em"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--arctic-blue-primary-hover)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="var(--arctic-blue-primary)"},children:["start shopping",a.jsx(c,{className:"w-4 h-4"})]})]})]})]})]})}export{d as default};
