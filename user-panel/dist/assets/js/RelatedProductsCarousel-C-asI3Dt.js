import{g as e,j as t}from"./index-DYE1wTmL.js";import{r as a}from"./react-vendor-D-XgqoRR.js";import{a as s}from"./session-DZPRxyc_.js";import{P as r}from"./PricingDisplay-CTuIcFWY.js";import{u as l,V as o}from"./VerifiedBadge-DuECU-4n.js";import{g as n,a as i,h as c}from"./product_reviews-C18bXWrN.js";import{ae as d,af as m}from"./ui-vendor-CK_V9qH3.js";import"./socket-vendor-CUkmNz_4.js";const u=new Map;function h({productId:h,type:p="related",title:f,className:g=""}){const[x,v]=a.useState([]),[w,j]=a.useState(!0),[y,b]=a.useState(0),N=a.useMemo(()=>x.map(e=>e.slug||"").filter(e=>e),[x]),{stats:k}=l(N),z=Math.ceil(x.length/4),C=4*y,$=C+4,M=x.slice(C,$),_=y>0,B=y<z-1;a.useEffect(()=>{P(),b(0)},[h,p]);const L=t=>{if(!t)return"";if(/^https?:\/\//i.test(t))return t;return`${e().replace(/\/$/,"")}${t.startsWith("/")?t:`/${t}`}`},P=async()=>{try{j(!0);const t=`${p}-${h}`,a=u.get(t);if(a&&Date.now()-a.timestamp<12e4)return v(a.data),void j(!1);const r=e();let l="";l="related"===p?`${r}/api/recommendations/related/${h}`:`${r}/api/recommendations?type=${p}&limit=8`;const o=await fetch(l,{credentials:"include",headers:s()});if(o.ok){const e=await o.json(),a=(Array.isArray(e)?e:e.products||[]).map(e=>({...e,listImage:L(e.list_image||e.listImage)}));v(a),u.set(t,{data:a,timestamp:Date.now()})}}catch(t){}finally{j(!1)}};return w||0===x.length?null:t.jsxs("section",{className:`py-8 md:py-12 ${g}`,children:[t.jsx("style",{children:"\n        .amazon-carousel-container {\n          scrollbar-width: none;\n          -ms-overflow-style: none;\n          scroll-behavior: smooth;\n          -webkit-overflow-scrolling: touch;\n        }\n        .amazon-carousel-container::-webkit-scrollbar {\n          display: none;\n        }\n        .amazon-carousel-fade-left {\n          background: linear-gradient(to right, rgba(255,255,255,1) 0%, rgba(255,255,255,0.8) 20%, transparent 100%);\n          pointer-events: none;\n        }\n        .amazon-carousel-fade-right {\n          background: linear-gradient(to left, rgba(255,255,255,1) 0%, rgba(255,255,255,0.8) 20%, transparent 100%);\n          pointer-events: none;\n        }\n        .amazon-carousel-item {\n          transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;\n        }\n        .amazon-carousel-item:hover {\n          transform: translateY(-4px) scale(1.02);\n        }\n      "}),t.jsxs("div",{className:"mx-auto max-w-7xl px-4",children:[t.jsx("h2",{className:"text-2xl md:text-3xl font-serif mb-6",style:{color:"#1B4965"},children:(()=>{if(f)return f;switch(p){case"related":return"Complete the Routine";case"recommended":return"You May Also Like";case"trending":return"Trending Products";default:return"Related Products"}})()}),t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:()=>{_&&b(e=>e-1)},className:"absolute left-2 top-1/2 -translate-y-1/2 z-30 bg-white rounded-full p-3 shadow-lg hover:shadow-xl transition-all duration-300 "+(_?"opacity-100 hover:scale-110 cursor-pointer":"opacity-0 pointer-events-none"),style:{backgroundColor:"#fff"},"aria-label":"Previous",disabled:!_,children:t.jsx(d,{className:"w-6 h-6",style:{color:"#1B4965"}})}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:M.map(e=>{const a=e.listImage||e.list_image||e.pdp_images&&e.pdp_images[0]||"",s=L(a),l=e.slug||e.id||"",d=l?`#/user/product/${l}`:"#/user/";return t.jsxs("a",{href:d,onClick:e=>{l&&(e.preventDefault(),window.location.hash=d)},className:"bg-white rounded-lg shadow-sm overflow-hidden group hover:shadow-xl transition-all duration-300 flex flex-col cursor-pointer",children:[s?t.jsx("div",{className:"relative overflow-hidden aspect-square bg-gray-100",children:t.jsx("img",{src:s,alt:e.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",onError:e=>{const t=e.target;t.style.display="none";const a=t.parentElement;a&&(a.innerHTML='<div class="w-full h-full bg-gray-200 flex items-center justify-center"><svg class="w-16 h-16 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg></div>')}})}):t.jsx("div",{className:"relative overflow-hidden aspect-square bg-gray-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-16 h-16 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[t.jsx("h3",{className:"font-medium mb-2 line-clamp-2",style:{color:"#1B4965"},children:e.title}),(()=>{const a=e.slug||"",s=k[a],r=(null==s?void 0:s.average_rating)>0?s.average_rating:n(a),l=(null==s?void 0:s.review_count)>0?s.review_count:i(a),d=(null==s?void 0:s.verified_count)>0||c(a);return r>0?t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("div",{className:"flex text-yellow-400",children:[...Array(5)].map((e,a)=>{const s=a<Math.round(r);return t.jsx("svg",{className:"w-4 h-4 "+(s?"text-yellow-400":"text-gray-300"),fill:s?"currentColor":"none",stroke:s?"none":"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},a)})}),t.jsxs("span",{className:"text-xs sm:text-sm ml-2 font-light",style:{color:"#999"},children:[r.toFixed(1)," (",l,")"]}),d&&t.jsx(o,{size:"sm",className:"ml-1.5"})]}):null})(),t.jsx("div",{className:"mb-3",children:t.jsx(r,{product:e})}),t.jsx("div",{className:"mt-auto",children:t.jsx("button",{className:"w-full px-4 py-2 text-white text-sm font-medium rounded-lg transition-all hover:scale-105",style:{backgroundColor:"#4B97C9"},onClick:e=>{e.preventDefault(),e.stopPropagation(),l&&(window.location.hash=d)},children:"View Product"})})]})]},e.id||e.slug)})}),t.jsx("button",{onClick:()=>{B&&b(e=>e+1)},className:"absolute right-2 top-1/2 -translate-y-1/2 z-30 bg-white rounded-full p-3 shadow-lg hover:shadow-xl transition-all duration-300 "+(B?"opacity-100 hover:scale-110 cursor-pointer":"opacity-0 pointer-events-none"),style:{backgroundColor:"#fff"},"aria-label":"Next",disabled:!B,children:t.jsx(m,{className:"w-6 h-6",style:{color:"#1B4965"}})})]})]})]})}export{h as default};
