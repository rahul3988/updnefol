import{j as e,b as s}from"./index-DrsU3FnI.js";import{r}from"./react-vendor-D-XgqoRR.js";import{K as t,P as a,F as d,i,j as l,X as n}from"./ui-vendor-BjTBABCK.js";import"./socket-vendor-CUkmNz_4.js";const o=[{key:"ordered",label:"Ordered"},{key:"shipped",label:"Shipped"},{key:"out-for-delivery",label:"Out for delivery"},{key:"delivered",label:"Delivered"}];function c(e){if(e.estimated_delivery){return`Arriving ${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date(e.estimated_delivery).getDay()]}`}const s=new Date(e.created_at),r=new Date(s);r.setDate(r.getDate()+4);return`Arriving ${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][r.getDay()]}`}function m(){const[m,g]=r.useState(""),[h,x]=r.useState(""),[p,u]=r.useState(!1),[y,b]=r.useState(null),[f,j]=r.useState(null),v=f?(e=>{const s=e.toLowerCase().replace(/\s+/g,"-");return"created"===s||"ordered"===s?0:"shipped"===s?1:"out-for-delivery"===s||"out for delivery"===s?2:"delivered"===s||"completed"===s?3:0})(f.status):-1;return e.jsx("main",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"mx-auto max-w-4xl px-4",children:[!f&&e.jsxs("section",{className:"rounded-lg border border-gray-200 bg-white p-8 shadow-sm mb-8",children:[e.jsxs("header",{className:"mb-6 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Track Your Order"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Enter your order number to track your package"})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),m.trim())try{u(!0),b(null);const e=await s.orders.getById(m.trim());if(h&&e.customer_email&&e.customer_email!==h.trim())return b("Email does not match our records for this order."),void j(null);j(e)}catch(r){b((null==r?void 0:r.message)||"Order not found. Please verify the details and try again."),j(null)}finally{u(!1)}else b("Please enter your order number.")},className:"grid gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Order Number"}),e.jsx("input",{type:"text",value:m,onChange:e=>g(e.target.value),placeholder:"e.g. NEFOL-20251027-1234",className:"mt-2 w-full rounded-lg border border-gray-300 px-4 py-3 text-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Email (optional)"}),e.jsx("input",{type:"email",value:h,onChange:e=>x(e.target.value),placeholder:"For verification",className:"mt-2 w-full rounded-lg border border-gray-300 px-4 py-3 text-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-200"})]}),e.jsx("div",{className:"sm:col-span-3",children:e.jsx("button",{type:"submit",className:"w-full rounded-lg bg-gray-900 px-4 py-3 text-sm font-semibold text-white transition hover:bg-gray-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:p,children:p?"Fetching statusâ€¦":"Track Order"})})]}),y&&e.jsx("div",{className:"mt-6 rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-700",children:y})]}),f&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:c(f)})}),f.items&&f.items.length>0&&e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsx("h3",{className:"text-base font-medium text-gray-900 leading-relaxed",children:(()=>{const e=f.items[0];let s=e.name||e.title||"Product";if(e.details){let r=e.details;if("string"==typeof r)try{r=JSON.parse(r)}catch{r.length>50&&(s=r)}if("object"==typeof r){const e=r.subtitle||r["Subtitle / Tagline"],t=r.longDescription||r["Product Description (Long)"];t?s=t:e&&(s=`${s} | ${e}`)}}return s})()}),f.items.length>1&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["+ ",f.items.length-1," more item",f.items.length>2?"s":""]})]}),e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-6 left-0 right-0 h-0.5 bg-gray-300",children:e.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:v/(o.length-1)*100+"%"}})}),e.jsx("div",{className:"relative flex items-center justify-between",children:o.map((s,r)=>{const d=v>r,i=v===r;return e.jsxs("div",{className:"flex flex-col items-center relative z-10",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center border-2 transition "+(d?"bg-green-500 border-green-500 text-white":i?"bg-blue-500 border-blue-500 text-white":"bg-white border-gray-300 text-gray-400"),children:d?e.jsx(t,{className:"w-6 h-6"}):i?e.jsx(a,{className:"w-6 h-6"}):e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-300"})}),e.jsx("p",{className:"mt-2 text-xs font-medium text-center "+(d||i?"text-gray-900":"text-gray-500"),children:s.label})]},s.key)})})]})}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delivery Info"}),e.jsxs("button",{className:"mb-4 flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[e.jsx(d,{className:"w-4 h-4"}),"Update delivery instructions"]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(i,{className:"w-4 h-4"}),"Shipping Address"]}),e.jsx("div",{className:"text-sm text-gray-600 space-y-1",children:f.shipping_address?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[f.shipping_address.firstName||f.shipping_address.first_name||f.customer_name||""," ",f.shipping_address.lastName||f.shipping_address.last_name||""]}),f.shipping_address.address&&e.jsx("p",{children:f.shipping_address.address}),f.shipping_address.apartment&&e.jsx("p",{children:f.shipping_address.apartment}),f.shipping_address.street&&e.jsx("p",{children:f.shipping_address.street}),f.shipping_address.area&&e.jsx("p",{children:f.shipping_address.area}),f.shipping_address.landmark&&e.jsx("p",{children:f.shipping_address.landmark}),e.jsxs("p",{children:[(f.shipping_address.city||"").toUpperCase(),f.shipping_address.city&&f.shipping_address.state&&", ",(f.shipping_address.state||"").toUpperCase()," ",f.shipping_address.zip||""]})]}):e.jsx("p",{className:"text-gray-500",children:"Address not available"})})]})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Info"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>window.location.hash=`#/user/order/${f.order_number}`,className:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition",children:[e.jsx(l,{className:"w-4 h-4"}),"View order details"]}),"delivered"!==f.status&&"completed"!==f.status&&"cancelled"!==f.status&&e.jsxs("button",{onClick:()=>window.location.hash=`#/user/cancel-order/${f.order_number}`,className:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-red-300 rounded-lg text-sm font-medium text-red-600 hover:bg-red-50 transition",children:[e.jsx(n,{className:"w-4 h-4"}),"Cancel order"]})]})]})]})]})})}export{m as default};
