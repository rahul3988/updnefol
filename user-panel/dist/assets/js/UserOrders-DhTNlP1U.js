import{u as e,b as t,j as a,g as r}from"./index-BGPhOdHQ.js";import{r as s}from"./react-vendor-D-XgqoRR.js";import{b as n,u as d,P as l,v as o,d as i,w as c,R as x}from"./ui-vendor-CK_V9qH3.js";import"./socket-vendor-CUkmNz_4.js";function m(){var m,h,g;const{isAuthenticated:u}=e(),[p,b]=s.useState([]),[v,k]=s.useState(!0),[j,N]=s.useState(""),[y,f]=s.useState("all"),[w,_]=s.useState("3months"),[C,L]=s.useState(!1);s.useEffect(()=>{u?S():k(!1)},[u]);const S=async()=>{try{k(!0);const e=await t.orders.getAll(),a=localStorage.getItem("token");if(!a)return void b([]);a.split("_")[2];const r=e.map(e=>({id:e.id.toString(),order_number:e.order_number,status:e.status,total:parseFloat(e.total),date:new Date(e.created_at).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),created_at:e.created_at,items:Array.isArray(e.items)?e.items:[],tracking_number:e.tracking_number,estimated_delivery:e.estimated_delivery,shipping_address:e.shipping_address}));b(r)}catch(e){b([])}finally{k(!1)}},D=e=>{switch(e.toLowerCase()){case"completed":case"delivered":return"text-green-700 dark:text-green-400";case"shipped":return"text-blue-700 dark:text-blue-400";case"processing":case"pending":return"text-yellow-700 dark:text-yellow-400";case"pending_payment":case"pending-payment":return"text-orange-700 dark:text-orange-400";case"cancelled":return"text-red-700 dark:text-red-400";default:return"text-gray-700 dark:text-gray-400"}},$=p.filter(e=>{if("all"!==w){const t=(e=>{const t=new Date;switch(e){case"3months":{const e=new Date(t);return e.setMonth(e.getMonth()-3),e}case"6months":{const e=new Date(t);return e.setMonth(e.getMonth()-6),e}case"year":{const e=new Date(t);return e.setFullYear(e.getFullYear()-1),e}default:return new Date(0)}})(w);if((e.created_at?new Date(e.created_at):new Date(e.date))<t)return!1}if("buy-again"===y)return"delivered"===e.status.toLowerCase()||"completed"===e.status.toLowerCase();if("not-shipped"===y)return"delivered"!==e.status.toLowerCase()&&"completed"!==e.status.toLowerCase()&&"cancelled"!==e.status.toLowerCase()&&"pending_payment"!==e.status.toLowerCase()&&"pending-payment"!==e.status.toLowerCase();if("cancelled"===y)return"cancelled"===e.status.toLowerCase();if("pending-payment"===y)return"pending_payment"===e.status.toLowerCase()||"pending-payment"===e.status.toLowerCase();if(j){const t=j.toLowerCase();return e.order_number.toLowerCase().includes(t)||e.items.some(e=>{var a;return null==(a=e.name)?void 0:a.toLowerCase().includes(t)})}return!0});if(v)return a.jsx("main",{className:"py-10 dark:bg-slate-900 min-h-screen",children:a.jsx("div",{className:"mx-auto max-w-4xl px-4",children:a.jsx("div",{className:"text-center",children:a.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Loading your orders..."})})})});const F=[{value:"3months",label:"past 3 months"},{value:"6months",label:"past 6 months"},{value:"year",label:"2025"},{value:"all",label:"All orders"}];return a.jsx("main",{className:"bg-gray-50 dark:bg-slate-900 min-h-screen py-6",children:a.jsxs("div",{className:"mx-auto max-w-6xl px-4",children:[a.jsx("div",{className:"mb-6",children:a.jsx("h1",{className:"text-2xl font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"Your Orders"})}),a.jsx("div",{className:"mb-4",children:a.jsxs("div",{className:"relative",children:[a.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search all orders",value:j,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]})}),a.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-md shadow-sm border border-slate-200 dark:border-slate-700 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[a.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[a.jsx("button",{onClick:()=>f("all"),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors "+("all"===y?"bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 border-b-2 border-orange-500":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"),children:"Orders"}),a.jsx("button",{onClick:()=>f("buy-again"),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors "+("buy-again"===y?"bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 border-b-2 border-orange-500":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"),children:"Buy Again"}),a.jsx("button",{onClick:()=>f("not-shipped"),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors "+("not-shipped"===y?"bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 border-b-2 border-orange-500":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"),children:"Not Yet Shipped"}),a.jsx("button",{onClick:()=>f("cancelled"),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors "+("cancelled"===y?"bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 border-b-2 border-orange-500":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"),children:"Cancelled Orders"}),a.jsx("button",{onClick:()=>f("pending-payment"),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors "+("pending-payment"===y?"bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 border-b-2 border-orange-500":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"),children:"Pending Payment"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>L(!C),className:"flex items-center gap-1 px-3 py-2 text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100 border border-slate-300 dark:border-slate-600 rounded-md hover:border-orange-500 dark:hover:border-orange-500",children:[a.jsx("span",{children:(null==(m=F.find(e=>e.value===w))?void 0:m.label)||"past 3 months"}),a.jsx(d,{className:"w-4 h-4 transition-transform "+(C?"rotate-180":"")})]}),C&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>L(!1)}),a.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-slate-800 rounded-md shadow-lg border border-slate-200 dark:border-slate-700 z-20",children:F.map(e=>a.jsx("button",{onClick:()=>{_(e.value),L(!1)},className:"w-full text-left px-4 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-700 first:rounded-t-md last:rounded-b-md "+(w===e.value?"bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400":"text-slate-700 dark:text-slate-300"),children:e.label},e.value))})]})]})]})}),0===$.length?a.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-md shadow-sm border border-slate-200 dark:border-slate-700 p-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx(l,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-2",children:0===p.length?a.jsxs(a.Fragment,{children:["0 orders placed in ",(null==(h=F.find(e=>e.value===w))?void 0:h.label)||"past 3 months"]}):a.jsxs(a.Fragment,{children:["buy-again"===y&&"No orders available to buy again","not-shipped"===y&&"No orders pending shipment","cancelled"===y&&"No cancelled orders","pending-payment"===y&&"No orders with pending payment","all"===y&&`0 orders placed in ${(null==(g=F.find(e=>e.value===w))?void 0:g.label)||"past 3 months"}`]})}),a.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:0===p.length?a.jsxs(a.Fragment,{children:["Looks like you haven't placed an order in the last 3 months.","year"!==w&&a.jsx("button",{onClick:()=>_("year"),className:"text-orange-600 dark:text-orange-400 hover:underline ml-1",children:"View orders in 2025"})]}):"Try selecting a different time period or filter."}),0===p.length&&a.jsx("div",{className:"mt-6",children:a.jsx("a",{href:"#/user/shop",className:"inline-block bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-md font-medium transition-colors",children:"Start Shopping"})}),a.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-200 dark:border-slate-700",children:[a.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"› View or edit your browsing history"}),a.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-500 mt-1",children:"After viewing product detail pages, look here to find an easy way to navigate back to pages you are interested in."})]})]})}):a.jsx("div",{className:"space-y-4",children:$.map(e=>a.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-md shadow-sm border border-slate-200 dark:border-slate-700",children:[a.jsx("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[a.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Order placed ",a.jsx("span",{className:"font-medium",children:e.date})]}),a.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Order #",e.order_number]}),e.tracking_number&&a.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Tracking: ",a.jsx("span",{className:"font-medium",children:e.tracking_number})]})]}),a.jsxs("div",{className:`text-sm font-medium ${D(e.status)}`,children:["delivered"===e.status&&"Delivered","shipped"===e.status&&"Shipped","processing"===e.status&&"Processing","pending"===e.status&&"Pending",("pending_payment"===e.status||"pending-payment"===e.status)&&"Pending Payment","cancelled"===e.status&&"Cancelled",e.estimated_delivery&&"shipped"===e.status&&a.jsxs("span",{className:"text-slate-600 dark:text-slate-400 ml-2",children:["Expected delivery: ",new Date(e.estimated_delivery).toLocaleDateString()]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["₹",e.total.toLocaleString("en-IN")]}),a.jsx("button",{onClick:()=>window.location.hash=`#/user/order/${e.order_number}`,className:"text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 hover:underline mt-1",children:"Order Details"})]})]})}),a.jsx("div",{className:"p-4",children:e.items.map((t,s)=>{const n=t.list_image||t.image||t.product_image,d=n&&n.startsWith("http")?n:n?`${r()}${n.startsWith("/")?"":"/"}${n}`:null,m=t.name||t.title||"Product",h=t.slug||"",g=h?`#/product/${h}`:`#/user/order/${e.order_number}`;return a.jsxs("div",{className:"flex gap-4 mb-4 last:mb-0 pb-4 border-b border-slate-200 dark:border-slate-700 last:border-0",children:[a.jsx("a",{href:g,className:"w-24 h-24 bg-slate-100 dark:bg-slate-700 rounded-md flex items-center justify-center flex-shrink-0 overflow-hidden hover:opacity-90 transition-opacity cursor-pointer",children:d?a.jsx("img",{src:d,alt:m,className:"w-full h-full object-cover rounded-md",onError:e=>{e.target.style.display="none"}}):a.jsx(l,{className:"w-8 h-8 text-slate-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("a",{href:g,className:"block",children:a.jsx("h4",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 mb-1 hover:text-orange-600 dark:hover:text-orange-400 transition-colors cursor-pointer",children:m})}),a.jsxs("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-2",children:["Quantity: ",t.quantity||1]}),a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:["delivered"===e.status&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 hover:underline flex items-center gap-1",children:[a.jsx(o,{className:"w-4 h-4"}),"Write a product review"]}),a.jsxs("button",{className:"text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 hover:underline flex items-center gap-1",children:[a.jsx(i,{className:"w-4 h-4"}),"Buy it again"]})]}),"shipped"===e.status&&a.jsxs("button",{className:"text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 hover:underline flex items-center gap-1",children:[a.jsx(c,{className:"w-4 h-4"}),"Track package"]}),("pending_payment"===e.status||"pending-payment"===e.status)&&a.jsx("button",{onClick:()=>window.location.hash=`#/user/checkout?order=${e.order_number}`,className:"text-sm bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md font-medium transition-colors",children:"Pay Now"}),"delivered"!==e.status&&"shipped"!==e.status&&"cancelled"!==e.status&&"pending_payment"!==e.status&&"pending-payment"!==e.status&&a.jsx("button",{className:"text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 hover:underline",children:"View order details"}),"cancelled"===e.status&&a.jsxs("button",{className:"text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 hover:underline flex items-center gap-1",children:[a.jsx(x,{className:"w-4 h-4"}),"Order again"]})]})]}),a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:["₹",parseFloat(t.price||0).toLocaleString("en-IN")]})})]},s)})}),a.jsx("div",{className:"px-4 py-3 bg-slate-50 dark:bg-slate-900/50 border-t border-slate-200 dark:border-slate-700",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:["shipped"===e.status&&a.jsx("button",{className:"text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 hover:underline",children:"Track package"}),"delivered"===e.status&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 hover:underline",children:"Get invoice"}),a.jsxs("button",{className:"text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 hover:underline flex items-center gap-1",children:[a.jsx(i,{className:"w-4 h-4"}),"Buy it again"]})]}),("pending_payment"===e.status||"pending-payment"===e.status)&&a.jsx("button",{onClick:()=>window.location.hash=`#/user/checkout?order=${e.order_number}`,className:"text-sm bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md font-medium transition-colors",children:"Pay Now"}),"cancelled"!==e.status&&"pending_payment"!==e.status&&"pending-payment"!==e.status&&a.jsx("button",{onClick:()=>window.location.hash=`#/user/order/${e.order_number}`,className:"text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 hover:underline",children:"View order details"}),a.jsx("button",{className:"text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100 hover:underline",children:"Archive order"})]})})]},e.id))})]})})}export{m as default};
