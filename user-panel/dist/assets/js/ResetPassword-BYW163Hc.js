import{j as e,a as s}from"./index-DHQYPLw0.js";import{r as t}from"./react-vendor-D-XgqoRR.js";import{g as a,h as r,E as l,i as n}from"./ui-vendor-upD1L4Zc.js";import"./socket-vendor-CUkmNz_4.js";function o(){const[o,d]=t.useState(""),[i,c]=t.useState(""),[m,u]=t.useState(""),[x,p]=t.useState(!1),[g,h]=t.useState(!1),[b,w]=t.useState(""),[f,y]=t.useState(""),[v,j]=t.useState(!1),[N,k]=t.useState(!1);t.useEffect(()=>{const e=new URLSearchParams(window.location.search),s=e.get("token"),t=e.get("email");s&&t&&(k(!0),d(decodeURIComponent(t)),window.resetToken=s)},[]);return e.jsx("div",{className:"min-h-screen bg-white py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-light tracking-[0.15em] mb-3",style:{fontFamily:"var(--font-heading-family)"},children:"Reset Password"}),e.jsx("p",{className:"text-sm text-slate-600 tracking-wide",children:N?"Enter your new password below.":"Enter your email address and we'll send you a reset link."})]}),e.jsx("div",{className:"rounded-2xl border border-slate-200 p-6 bg-white shadow-sm",children:N?e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),w(""),y("");const t=new URLSearchParams(window.location.search).get("token");if(t)if(i.length<8)y("Password must be at least 8 characters");else if(i===m){j(!0);try{await s.resetPassword({email:o.trim(),token:t,newPassword:i}),w("Password reset successful! Redirecting to login..."),c(""),u(""),setTimeout(()=>{window.location.hash="#/user/login"},2e3)}catch(a){y((null==a?void 0:a.message)||"Failed to reset password. The link may have expired. Please request a new one.")}finally{j(!1)}}else y("Passwords do not match");else y("Invalid reset link. Please request a new password reset.")},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-light text-slate-700 mb-2 uppercase tracking-[0.1em]",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 z-10 pointer-events-none"}),e.jsx("input",{type:"email",value:o,readOnly:!0,className:"pl-11 pr-3 w-full rounded-md border border-slate-200 py-2.5 text-sm bg-slate-50 text-slate-600"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-light text-slate-700 mb-2 uppercase tracking-[0.1em]",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 z-10 pointer-events-none"}),e.jsx("input",{type:x?"text":"password",value:i,onChange:e=>c(e.target.value),className:"pl-11 pr-11 w-full rounded-md border border-slate-200 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter new password",required:!0}),e.jsx("button",{type:"button",onClick:()=>p(!x),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 z-10",children:x?e.jsx(l,{className:"h-4 w-4"}):e.jsx(n,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-light text-slate-700 mb-2 uppercase tracking-[0.1em]",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 z-10 pointer-events-none"}),e.jsx("input",{type:g?"text":"password",value:m,onChange:e=>u(e.target.value),className:"pl-11 pr-11 w-full rounded-md border border-slate-200 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Re-enter new password",required:!0}),e.jsx("button",{type:"button",onClick:()=>h(!g),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 z-10",children:g?e.jsx(l,{className:"h-4 w-4"}):e.jsx(n,{className:"h-4 w-4"})})]})]}),f&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-md",children:f}),b&&e.jsx("div",{className:"text-sm text-green-600 bg-green-50 p-3 rounded-md",children:b}),e.jsx("button",{type:"submit",disabled:v,className:"w-full rounded-md text-white py-3 text-xs font-light uppercase tracking-[0.15em] disabled:opacity-50 transition-colors",style:{backgroundColor:"rgb(75,151,201)"},onMouseEnter:e=>!e.currentTarget.disabled&&(e.currentTarget.style.backgroundColor="rgb(60,120,160)"),onMouseLeave:e=>!e.currentTarget.disabled&&(e.currentTarget.style.backgroundColor="rgb(75,151,201)"),children:v?"Updating...":"Update Password"})]}):e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),w(""),y(""),!o.trim())return void y("Please enter a valid email address");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.trim())){j(!0);try{await s.requestPasswordReset({email:o.trim()}),w("If an account exists, a password reset link has been sent to your email."),d("")}catch(t){y((null==t?void 0:t.message)||"Failed to request reset. Please try again.")}finally{j(!1)}}else y("Please enter a valid email address")},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-light text-slate-700 mb-2 uppercase tracking-[0.1em]",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 z-10 pointer-events-none"}),e.jsx("input",{type:"email",value:o,onChange:e=>d(e.target.value),className:"pl-11 pr-3 w-full rounded-md border border-slate-200 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your email address",required:!0})]})]}),f&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-md",children:f}),b&&e.jsx("div",{className:"text-sm text-green-600 bg-green-50 p-3 rounded-md",children:b}),e.jsx("button",{type:"submit",disabled:v,className:"w-full rounded-md text-white py-3 text-xs font-light uppercase tracking-[0.15em] disabled:opacity-50 transition-colors",style:{backgroundColor:"rgb(75,151,201)"},onMouseEnter:e=>!e.currentTarget.disabled&&(e.currentTarget.style.backgroundColor="rgb(60,120,160)"),onMouseLeave:e=>!e.currentTarget.disabled&&(e.currentTarget.style.backgroundColor="rgb(75,151,201)"),children:v?"Sending...":"Send Reset Link"})]})})]})})}export{o as default};
