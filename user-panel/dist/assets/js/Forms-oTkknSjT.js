import{u as e,j as r}from"./index-DrsU3FnI.js";import{r as a}from"./react-vendor-D-XgqoRR.js";import{X as t,K as s,a3 as l,w as d}from"./ui-vendor-BjTBABCK.js";import"./socket-vendor-CUkmNz_4.js";const i="http://192.168.1.36:2000";function n(){var n;const{user:o}=e(),[c,u]=a.useState([]),[x,m]=a.useState(!0),[g,b]=a.useState(null),[h,y]=a.useState({}),[p,f]=a.useState(!1),[k,v]=a.useState(!1),[j,N]=a.useState("");a.useEffect(()=>{w()},[]);const w=async()=>{try{m(!0);const e=await fetch(`${i}/api/forms`);if(e.ok){const r=await e.json(),a=(r.forms||r||[]).filter(e=>"active"===e.status).map(e=>({...e,fields:"string"==typeof e.fields?JSON.parse(e.fields):e.fields||[]}));u(a)}}catch(e){}finally{m(!1)}},q=(e,r)=>{y({...h,[e]:r})},C=async e=>{if(e.preventDefault(),N(""),v(!1),g&&(()=>{if(!g)return!1;for(const e of g.fields)if(e.required){const r=h[e.id];if(!r||"string"==typeof r&&""===r.trim())return N(`Please fill in the required field: ${e.label}`),!1}return!0})()){f(!0);try{const e={...h,...(null==o?void 0:o.email)&&{email:o.email},...(null==o?void 0:o.name)&&{name:o.name}},r=await fetch(`${i}/api/forms/${g.id}/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e,userEmail:(null==o?void 0:o.email)||"",userName:(null==o?void 0:o.name)||""})}),a=await r.json();if(!r.ok)throw new Error(a.error||"Failed to submit form");v(!0),y({}),setTimeout(()=>{b(null),v(!1),y({})},3e3)}catch(r){N(r.message||"Failed to submit form. Please try again.")}finally{f(!1)}}},S=e=>{var a,t,s,l,i;const n=h[e.id]||"";switch(e.type){case"text":case"email":case"phone":return r.jsx("input",{type:"phone"===e.type?"tel":e.type,id:e.id,value:n,onChange:r=>q(e.id,r.target.value),placeholder:e.placeholder,required:e.required,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"});case"textarea":return r.jsx("textarea",{id:e.id,value:n,onChange:r=>q(e.id,r.target.value),placeholder:e.placeholder,required:e.required,rows:4,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"});case"select":return r.jsxs("select",{id:e.id,value:n,onChange:r=>q(e.id,r.target.value),required:e.required,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[r.jsx("option",{value:"",children:"Select an option"}),null==(a=e.options)?void 0:a.map((e,a)=>r.jsx("option",{value:e,children:e},a))]});case"checkbox":return r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"checkbox",id:e.id,checked:!!n,onChange:r=>q(e.id,r.target.checked),required:e.required,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),r.jsx("label",{htmlFor:e.id,className:"text-sm text-gray-700 dark:text-gray-300",children:e.label})]});case"radio":return r.jsx("div",{className:"space-y-2",children:null==(t=e.options)?void 0:t.map((a,t)=>r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"radio",id:`${e.id}-${t}`,name:e.id,value:a,checked:n===a,onChange:r=>q(e.id,r.target.value),required:e.required,className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),r.jsx("label",{htmlFor:`${e.id}-${t}`,className:"text-sm text-gray-700 dark:text-gray-300",children:a})]},t))});case"date":return r.jsx("input",{type:"date",id:e.id,value:n,onChange:r=>q(e.id,r.target.value),required:e.required,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"});case"number":return r.jsx("input",{type:"number",id:e.id,value:n,onChange:r=>q(e.id,r.target.value),placeholder:e.placeholder,required:e.required,min:null==(s=e.validation)?void 0:s.min,max:null==(l=e.validation)?void 0:l.max,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"});case"file":return r.jsx("input",{type:"file",id:e.id,onChange:r=>{var a;const t=null==(a=r.target.files)?void 0:a[0];t&&q(e.id,t.name)},required:e.required,accept:null==(i=e.settings)?void 0:i.accept,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"});case"rating":return r.jsx("div",{className:"flex space-x-2",children:[1,2,3,4,5].map(a=>r.jsx("button",{type:"button",onClick:()=>q(e.id,a),className:(n>=a?"text-yellow-400":"text-gray-300 dark:text-gray-600")+" hover:text-yellow-400 transition-colors",children:r.jsx(d,{className:"h-8 w-8 fill-current"})},a))});default:return null}};return x?r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4",children:r.jsx("div",{className:"max-w-4xl mx-auto",children:r.jsx("div",{className:"flex items-center justify-center h-64"})})}):g?r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4",children:r.jsxs("div",{className:"max-w-2xl mx-auto",children:[r.jsxs("button",{onClick:()=>{b(null),y({}),v(!1),N("")},className:"mb-6 flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:[r.jsx(t,{className:"h-5 w-5 mr-2"}),"Back to Forms"]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:g.name}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Please fill out all required fields marked with *"}),k&&r.jsx("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(s,{className:"h-5 w-5 text-green-600 dark:text-green-400 mr-2"}),r.jsx("p",{className:"text-green-800 dark:text-green-300",children:"Form submitted successfully! Thank you for your response."})]})}),j&&r.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:r.jsx("p",{className:"text-red-800 dark:text-red-300",children:j})}),r.jsxs("form",{onSubmit:C,className:"space-y-6",children:[null==(n=g.fields)?void 0:n.map(e=>r.jsxs("div",{children:[r.jsxs("label",{htmlFor:e.id,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.label,e.required&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),S(e)]},e.id)),r.jsxs("div",{className:"flex space-x-4 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>{b(null),y({}),v(!1),N("")},className:"flex-1 px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:p,className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Submitting...":"Submit Form"})]})]})]})]})}):r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4",children:r.jsxs("div",{className:"max-w-6xl mx-auto",children:[r.jsxs("div",{className:"text-center mb-12",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Forms"}),r.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Fill out our forms to share your feedback, inquiries, and more"})]}),0===c.length?r.jsxs("div",{className:"text-center py-16",children:[r.jsx(l,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"No forms available"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"There are no published forms at the moment. Please check back later."})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(e=>{var a;return r.jsxs("div",{onClick:()=>b(e),className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-shadow border border-gray-200 dark:border-gray-700",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsx(l,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"}),void 0!==e.submission_count&&r.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.submission_count," submissions"]})]}),r.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:e.name}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[(null==(a=e.fields)?void 0:a.length)||0," fields"]}),r.jsx("button",{className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Fill Form"})]},e.id)})})]})})}export{n as default};
